000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. MENTEST.
000300
000400 ENVIRONMENT DIVISION.
000500 CONFIGURATION SECTION.
000600 SPECIAL-NAMES.
000700     DECIMAL-POINT IS COMMA.
000800
000900 DATA DIVISION.
001000 WORKING-STORAGE SECTION.
001100
001200 01  INPUT-NOTE        PIC 9(2)V9.
001400
001500 01  RESULT            PIC X(10).
001600 01  EXPECTED-RESULT   PIC X(10).
001700
001800 01  LIB PIC X(30).
001900 01  L-SEP PIC X(30) VALUE ALL '*'.
002000
002100 LINKAGE SECTION.
002200 COPY TESTCONT.
002300
002400 PROCEDURE DIVISION USING TEST-CONTEXT.
002500
002600     PERFORM ELIMINATION-TEST
002700     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
002800     DISPLAY L-SEP
002900
002910     PERFORM ELIMINATION-KO-TEST
002920     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
002930     DISPLAY L-SEP
002940
003000     PERFORM ECHEC-TEST
003100     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
003200     DISPLAY L-SEP
003300
003400     PERFORM RATT-TEST.
003500     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
003600     DISPLAY L-SEP
003700
003710     PERFORM INV-TEST.
003720     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
003730     DISPLAY L-SEP
003740
003800     GOBACK.
003900
004000 APPELS.
004100     CALL 'SMENTION' USING BY CONTENT INPUT-NOTE
004210                      BY REFERENCE RESULT
004300
004400     DISPLAY '******** ' LIB '*********'
004500     CALL 'ASSEQM' USING BY REFERENCE TEST-CONTEXT
004600                        BY CONTENT LIB
004700                        BY CONTENT EXPECTED-RESULT
004800                        BY CONTENT RESULT.
004900
005000 ELIMINATION-TEST.
005100     MOVE SPACE TO RESULT
005200     MOVE ZERO  TO INPUT-NOTE
005400     MOVE 'ELIMINE(E)' TO EXPECTED-RESULT
005500     MOVE 'ELIMINATION-TEST' TO LIB
005600     PERFORM APPELS.
005700
005800 INV-TEST.
005900     MOVE SPACE TO RESULT
006000     MOVE 20,1  TO INPUT-NOTE
006100     MOVE 'INVALIDE !' TO EXPECTED-RESULT
006200     MOVE 'INV-TEST' TO LIB
006300     PERFORM APPELS.
006310
006320 ELIMINATION-KO-TEST.
006330     MOVE SPACE TO RESULT
006340     MOVE 0,1   TO INPUT-NOTE
006350     MOVE 'ELIMINE(E)' TO EXPECTED-RESULT
006360     MOVE 'ELIMINATION-KO-TEST' TO LIB
006370     PERFORM APPELS.
006400
006500 ECHEC-TEST.
006600     MOVE SPACE TO RESULT
006700     MOVE 0,1   TO INPUT-NOTE
006800     MOVE 'ECHEC' TO EXPECTED-RESULT
006900     MOVE 'ECHEC-TEST' TO LIB
007000     PERFORM APPELS.
007100
007200 RATT-TEST.
007300     MOVE SPACE TO RESULT
007400     MOVE 8,1   TO INPUT-NOTE
007500     MOVE 'RATTRAPAGE' TO EXPECTED-RESULT
007600     MOVE 'RATT-TEST' TO LIB
007700     PERFORM APPELS.
