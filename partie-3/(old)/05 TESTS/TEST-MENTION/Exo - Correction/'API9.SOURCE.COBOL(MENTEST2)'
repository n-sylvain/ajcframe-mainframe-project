000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. MENTEST2.
000300
000400 ENVIRONMENT DIVISION.
000500 CONFIGURATION SECTION.
000600 SPECIAL-NAMES.
000700     DECIMAL-POINT IS COMMA.
000800
000900 DATA DIVISION.
001000 WORKING-STORAGE SECTION.
001010 77 CPT PIC 99 VALUE ZERO.
001100 01 ETIQ-TESTS.
001110    05 DATAS-TESTS OCCURS 4.
001120      10 T-NOTES    PIC 99V9.
001130      10 T-EXPECTED PIC X(10).
001140      10 T-LIB      PIC X(30).
001150
001160
001170
001180
001190
001191
001200 01  INPUT-NOTE        PIC 9(2)V9.
001400
001500 01  RESULT            PIC X(10).
001600 01  EXPECTED-RESULT   PIC X(10).
001700
001800 01  LIB PIC X(30).
001900 01  L-SEP PIC X(30) VALUE ALL '*'.
002000
002100 LINKAGE SECTION.
002200 COPY TESTCONT.
002300
002400 PROCEDURE DIVISION USING TEST-CONTEXT.
002500
002510     MOVE '000ELIMINE(E)ELIM-OK     ' TO DATAS-TESTS(1)
002511     MOVE '000ECHEC     ELIM-KO     ' TO DATAS-TESTS(2)
002512     MOVE '050ECHEC     ECHEC-OK    ' TO DATAS-TESTS(3)
002513     MOVE '050RATTRAPAGEECHEC-KO    ' TO DATAS-TESTS(4)
002550
002600     PERFORM VARYING CPT FROM 1 BY 1 UNTIL CPT > 4
002610         MOVE T-NOTES(CPT)     TO    INPUT-NOTE
002611         MOVE T-EXPECTED(CPT)  TO    EXPECTED-RESULT
002612         MOVE T-LIB(CPT)       TO    LIB
002630
002640         PERFORM APPELS
002700         DISPLAY 'RUN:' TESTS-RUN ' OK:' PASSES ' KO:' FAILURES
002800         DISPLAY L-SEP
002810
002900     END-PERFORM
003740
003800     GOBACK.
003900
004000 APPELS.
004100     CALL 'SMENTION' USING BY CONTENT INPUT-NOTE
004210                      BY REFERENCE RESULT
004300
004400     DISPLAY '******** ' LIB '*********'
004500     CALL 'ASSEQM' USING BY REFERENCE TEST-CONTEXT
004600                        BY CONTENT LIB
004700                        BY CONTENT EXPECTED-RESULT
004800                        BY CONTENT RESULT.
004900
