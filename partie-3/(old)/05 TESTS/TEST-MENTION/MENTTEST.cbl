000100*API8.SOURCE.COBOL(MENTTEST)
000200 IDENTIFICATION DIVISION.
000300 PROGRAM-ID. MENTTEST.
000400
000500 ENVIRONMENT DIVISION.
000600 CONFIGURATION SECTION.
000700 SPECIAL-NAMES.
000800     DECIMAL-POINT IS COMMA.
000900
001000 DATA DIVISION.
001100 WORKING-STORAGE SECTION.
001200
001300 01  INPUT-NOTE      PIC 9(2)V9.
001400 01  RESULT          PIC X(10).
001500 01  EXPECTED-RESULT PIC X(10).
001600
001700 01  LIB PIC X(30).
001800 01  L-SEP PIC X(30) VALUE ALL '*'.
001900
002000 LINKAGE SECTION.
002100 COPY TESTCONT.
002200
002300 PROCEDURE DIVISION USING TEST-CONTEXT.
002400
002500*TEST ALL GRADE RANGES
002600     PERFORM TEST-ELIMINE
002700     DISPLAY 'RUN: ' TESTS-RUN  ' | OK : ' PASSES
002800                                ' | KO : ' FAILURES
002900     DISPLAY L-SEP
003000
003100     PERFORM TEST-ECHEC
003200     DISPLAY 'RUN: ' TESTS-RUN  ' | OK : ' PASSES
003300                                ' | KO : ' FAILURES
003400     DISPLAY L-SEP
003500
003600     PERFORM TEST-RATTRAPAGE
003700     DISPLAY 'RUN: ' TESTS-RUN  ' | OK : ' PASSES
003800                                ' | KO : ' FAILURES
003900     DISPLAY L-SEP
004000
004100     PERFORM TEST-PASSABLE
004200     DISPLAY 'RUN: ' TESTS-RUN  ' | OK : ' PASSES
004300                                ' | KO : ' FAILURES
004400     DISPLAY L-SEP
004500
004600     PERFORM TEST-ASSEZ-BIEN
004700     DISPLAY 'RUN: ' TESTS-RUN  ' | OK : ' PASSES
004800                                ' | KO : ' FAILURES
004900     DISPLAY L-SEP
005000
005100     PERFORM TEST-BIEN
005200     DISPLAY 'RUN: ' TESTS-RUN  ' | OK : ' PASSES
005300                                ' | KO : ' FAILURES
005400     DISPLAY L-SEP
005500
005600     PERFORM TEST-TRES-BIEN
005700     DISPLAY 'RUN: ' TESTS-RUN  ' | OK : ' PASSES
005800                                ' | KO : ' FAILURES
005900     DISPLAY L-SEP
006000
006100     PERFORM TEST-INVALIDE
006200     DISPLAY 'RUN: ' TESTS-RUN  ' | OK : ' PASSES
006300                                ' | KO : ' FAILURES
006400     DISPLAY L-SEP
006500
006600     PERFORM TEST-BOUNDARY-CASES
006700     DISPLAY 'RUN: ' TESTS-RUN  ' | OK : ' PASSES
006800                                ' | KO : ' FAILURES
006900     DISPLAY L-SEP
007000
007100     GOBACK.
007200
007300*COMMON TEST EXECUTION PARAGRAPH
007400 APPELS.
007500     CALL 'SMENTION' USING BY CONTENT INPUT-NOTE
007600                           BY REFERENCE RESULT
007700
007800     DISPLAY '******** ' LIB '*********'
007900     CALL 'ASSEQSTR' USING BY REFERENCE TEST-CONTEXT
008000                           BY CONTENT LIB
008100                           BY CONTENT EXPECTED-RESULT
008200                           BY CONTENT RESULT.
008300
008400*INDIVIDUAL TEST CASES
008500 TEST-ELIMINE.
008600     MOVE ' ' TO RESULT 
008700     MOVE 0,0 TO INPUT-NOTE
008800     MOVE 'ELIMINE(E)' TO EXPECTED-RESULT
008900     MOVE 'TEST-ELIMINE' TO LIB
009000     PERFORM APPELS.
009100
009200 TEST-ECHEC.
009300     MOVE ' ' TO RESULT 
009400     MOVE 5,5 TO INPUT-NOTE
009500     MOVE 'ECHEC' TO EXPECTED-RESULT
009600     MOVE 'TEST-ECHEC' TO LIB
009700     PERFORM APPELS.
009800
009900 TEST-RATTRAPAGE.
010000     MOVE ' ' TO RESULT 
010100     MOVE 9,0 TO INPUT-NOTE
010200     MOVE 'RATTRAPAGE' TO EXPECTED-RESULT
010300     MOVE 'TEST-RATTRAPGE' TO LIB
010400     PERFORM APPELS.
010500
010600 TEST-PASSABLE.
010700     MOVE ' ' TO RESULT 
010800     MOVE 11,0 TO INPUT-NOTE
010900     MOVE 'PASSABLE' TO EXPECTED-RESULT
011000     MOVE 'TEST-PASSABLE' TO LIB
011100     PERFORM APPELS.
011200
011300 TEST-ASSEZ-BIEN.
011400     MOVE ' ' TO RESULT 
011500     MOVE 13,0 TO INPUT-NOTE
011600     MOVE 'ASSEZ BIEN' TO EXPECTED-RESULT
011700     MOVE 'TEST-ASSEZ-BIEN' TO LIB
011800     PERFORM APPELS.
011900
012000 TEST-BIEN.
012100     MOVE ' ' TO RESULT 
012200     MOVE 15,0 TO INPUT-NOTE
012300     MOVE 'BIEN' TO EXPECTED-RESULT
012400     MOVE 'TEST-BIEN' TO LIB
012500     PERFORM APPELS.
012600
012700 TEST-TRES-BIEN.
012800     MOVE ' ' TO RESULT 
012900     MOVE 18,0 TO INPUT-NOTE
013000     MOVE 'TRES BIEN' TO EXPECTED-RESULT
013100     MOVE 'TEST-TRES-BIEN' TO LIB
013200     PERFORM APPELS.
013300
013400 TEST-INVALIDE.
013500     MOVE ' ' TO RESULT 
013600     MOVE 25,0 TO INPUT-NOTE
013700     MOVE 'INVALIDE !' TO EXPECTED-RESULT
013800     MOVE 'TEST-INVALIDE' TO LIB
013900     PERFORM APPELS.
014000
014100 TEST-BOUNDARY-CASES.
014200*Test boundary at 8.0 (should be RATTRAPAGE)
013500     MOVE ' ' TO RESULT
014300     MOVE 8,0 TO INPUT-NOTE
014400     MOVE 'RATTRAPAGE' TO EXPECTED-RESULT
014500     MOVE 'TEST-BOUNDARY-8' TO LIB
014600     PERFORM APPELS
014700
014800*Test boundary at 7.9 (should be ECHEC)
013500     MOVE ' ' TO RESULT
014900     MOVE 7,9 TO INPUT-NOTE
015000     MOVE 'ECHEC' TO EXPECTED-RESULT
015100     MOVE 'TEST-BOUNDARY-7.9' TO LIB
015200     PERFORM APPELS
015300
015400*Test boundary at 20.0 (should be TRES BIEN)
013500     MOVE ' ' TO RESULT
015500     MOVE 20,0 TO INPUT-NOTE
015600     MOVE 'TRES BIEN' TO EXPECTED-RESULT
015700     MOVE 'TEST-BOUNDARY-20' TO LIB
015800     PERFORM APPELS.