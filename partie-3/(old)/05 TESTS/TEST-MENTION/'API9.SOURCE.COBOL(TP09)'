000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID.    TP09.
000210
000800********************************************************
000900 ENVIRONMENT DIVISION.
000901 CONFIGURATION SECTION.
000902 SPECIAL-NAMES.
000903     DECIMAL-POINT IS COMMA.
000905
000906 INPUT-OUTPUT SECTION.
000907 FILE-CONTROL.
000908      SELECT STUD ASSIGN TO STUDENTS
000909      ORGANIZATION IS SEQUENTIAL.
000910
000911      SELECT RES  ASSIGN TO RESULTAT
000912      ORGANIZATION IS SEQUENTIAL.
000913
000914********************************************************
000920 DATA DIVISION.
000921 FILE SECTION.
000922 FD STUD.
000923 01 ENR-STUD.
000924    05 MAT-STUD         PIC X(2).
000925    05 NOM-STUD         PIC X(10).
000929    05 NOTE-STUD        PIC 9(2)V9.
000931
000932 FD RES.
000933 01 ENR-RES    PIC X(40).
000934
000935 WORKING-STORAGE SECTION.
000940 77 WS-FLAG-STUD   PIC 9        VALUE ZERO.
000950    88 NFF-STUD    VALUE 0.
000951    88 FF-STUD     VALUE 1.
000952
000953 01 L-DETAIL.
000954   05 FILLER      PIC       XX      VALUE '* '.
000955   05 ED-MAT      PIC       99.
000956   05 FILLER      PIC       XXX     VALUE ' * '.
000957   05 ED-NOM      PIC       X(10).
000958   05 FILLER      PIC       XXX     VALUE ' * '.
000959   05 ED-NOTE     PIC       Z9,99.
000960   05 FILLER      PIC       XXX     VALUE ' * '.
000961   05 ED-MENTION  PIC       X(10).
000962   05 FILLER      PIC       XX      VALUE ' *'.
000963
000964 01 L-ETOILE      PIC X(40)         VALUE ALL '*'.
000965
000966
000967
000968
000969********************************************************
000970 PROCEDURE DIVISION.
000980     SET NFF-STUD TO TRUE
000981     OPEN INPUT STUD
000982
000983     OPEN OUTPUT RES
000984
000985
000986     PERFORM LECT-STUD
000987     PERFORM UNTIL FF-STUD
000990
000992          CALL 'SMENTION' USING BY CONTENT NOTE-STUD
000993                                BY REFERENCE ED-MENTION
000994
000995          PERFORM AFF-STUD
000996
001002          PERFORM LECT-STUD
001003
001004     END-PERFORM
001005     WRITE ENR-RES FROM L-ETOILE
001006
001016     CLOSE STUD RES
001017
001020     STOP RUN.
001100
001134
001135 AFF-STUD.
001136     WRITE ENR-RES FROM L-ETOILE
001137     MOVE MAT-STUD   TO   ED-MAT
001138     MOVE NOM-STUD   TO   ED-NOM
001139     MOVE NOTE-STUD  TO   ED-NOTE
001140     WRITE ENR-RES FROM L-DETAIL
001150     .
001191
001200 LECT-STUD.
001210      READ STUD AT END
001220          DISPLAY 'FIN DU FICHIER STUDENTS !'
001230          SET FF-STUD TO TRUE
001240      END-READ.
