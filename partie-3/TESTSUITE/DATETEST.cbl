000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. DATETEST.
000300
000400 ENVIRONMENT DIVISION.
000500 CONFIGURATION SECTION.
000600 SPECIAL-NAMES.
000700     DECIMAL-POINT IS COMMA.
000800
000900 DATA DIVISION.
001000 WORKING-STORAGE SECTION.
001100
001200 01  INPUT-DATE        PIC X(8).
001300 01  RESULT-DATE       PIC X(40).
001400 01  EXPECTED-DATE     PIC X(40).
001500 01  LIB               PIC X(30).
001600 01  L-SEP             PIC X(50) VALUE ALL '*'.
001700
001800 LINKAGE SECTION.
001900 COPY TESTCONT.
002000
002100 PROCEDURE DIVISION USING TEST-CONTEXT.
002200
002300     PERFORM TEST-DATE-CONNUE
002400     DISPLAY 'RUN: ' TESTS-RUN ' OK: ' PASSES ' KO: ' FAILURES
002500     DISPLAY L-SEP
002600
002700     PERFORM TEST-DATE-SAMEDI
002800     DISPLAY 'RUN: ' TESTS-RUN ' OK: ' PASSES ' KO: ' FAILURES
002900     DISPLAY L-SEP
003000
003100     PERFORM TEST-DATE-DIMANCHE
003200     DISPLAY 'RUN: ' TESTS-RUN ' OK: ' PASSES ' KO: ' FAILURES
003300     DISPLAY L-SEP
003400
003500     PERFORM TEST-DATE-VIDE
003600     DISPLAY 'RUN: ' TESTS-RUN ' OK: ' PASSES ' KO: ' FAILURES
003700     DISPLAY L-SEP
003800
003900     PERFORM TEST-DATE-PREMIER-JANVIER
004000     DISPLAY 'RUN: ' TESTS-RUN ' OK: ' PASSES ' KO: ' FAILURES
004100     DISPLAY L-SEP
004200
004300     GOBACK.
004400
004500 APPELS.
004600     CALL 'DATEFMT' USING BY REFERENCE INPUT-DATE
004700                          BY REFERENCE RESULT-DATE
004800
004900     DISPLAY '******** ' LIB ' *********'
005000     CALL 'ASSEQDT' USING BY REFERENCE TEST-CONTEXT
005100                          BY CONTENT LIB
005200                          BY CONTENT EXPECTED-DATE
005300                          BY CONTENT RESULT-DATE.
005400
005500 TEST-DATE-CONNUE.
005600     MOVE SPACES TO RESULT-DATE
005700     MOVE '20250826' TO INPUT-DATE
005800     MOVE 'TUESDAY  , AUGUST   26, 2025' TO EXPECTED-DATE
005900     MOVE 'TEST-DATE-CONNUE' TO LIB
006000     PERFORM APPELS.
006100
006200 TEST-DATE-SAMEDI.
006300     MOVE SPACES TO RESULT-DATE
006400     MOVE '20250823' TO INPUT-DATE
006500     MOVE 'SATURDAY , AUGUST   23, 2025' TO EXPECTED-DATE
006600     MOVE 'TEST-DATE-SAMEDI' TO LIB
006700     PERFORM APPELS.
006800
006900 TEST-DATE-DIMANCHE.
007000     MOVE SPACES TO RESULT-DATE
007100     MOVE '20250824' TO INPUT-DATE
007200     MOVE 'SUNDAY   , AUGUST   24, 2025' TO EXPECTED-DATE
007300     MOVE 'TEST-DATE-DIMANCHE' TO LIB
007400     PERFORM APPELS.
007500
007600 TEST-DATE-VIDE.
007700     MOVE SPACES TO RESULT-DATE
007800     MOVE SPACES TO INPUT-DATE
007900* DATE COURANTE ATTENDUE - A ADAPTER SELON L'EXECUTION
008000     MOVE 'TEST-DATE-VIDE (DATE COURANTE)' TO LIB
008100     CALL 'DATEFMT' USING BY REFERENCE INPUT-DATE
008200                          BY REFERENCE RESULT-DATE
008300     DISPLAY '******** ' LIB ' *********'
008400     DISPLAY 'DATE FORMATEE : [' RESULT-DATE ']'
008500     ADD 1 TO TESTS-RUN
008600     ADD 1 TO PASSES.
008700
008800 TEST-DATE-PREMIER-JANVIER.
008900     MOVE SPACES TO RESULT-DATE
009000     MOVE '20250101' TO INPUT-DATE
009100     MOVE 'WEDNESDAY, JANUARY  01, 2025' TO EXPECTED-DATE
009200     MOVE 'TEST-PREMIER-JANVIER' TO LIB
009300     PERFORM APPELS.