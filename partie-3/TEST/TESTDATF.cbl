000100 IDENTIFICATION DIVISION.
000200 PROGRAM-ID. TESTDATF.
000300
000400 DATA DIVISION.
001000 WORKING-STORAGE SECTION.
001100
001200 01  INPUT-DATE        PIC X(8).
001500 01  RESULT-DATE       PIC X(40).
001600 01  EXPECTED-RESULT   PIC X(40).
001700
001800 01  LIB PIC X(30).
001900 01  L-SEP PIC X(30) VALUE ALL '*'.
002000
002100 LINKAGE SECTION.
002200 COPY TESTCONT.
002300
002400 PROCEDURE DIVISION USING TEST-CONTEXT.
002500
002600     PERFORM DATE-OCTOBER-TEST
002700     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
002800     DISPLAY L-SEP
002900
003000     PERFORM JOUR-DE-L-AN-TEST
003100     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
003200     DISPLAY L-SEP
003300
003400     PERFORM FEVRIER-BISSEX-TEST
003500     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
003600     DISPLAY L-SEP
003700
003800     PERFORM FEVR-NON-BISSEX-TEST
003900     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
004000     DISPLAY L-SEP
004100
004200     PERFORM FEVR-1900-TEST
004300     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
004400     DISPLAY L-SEP
004500
004600     PERFORM DIMANCHE-CHG-HEURE-TEST
004700     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
004800     DISPLAY L-SEP

004600     PERFORM TEST-DATE-VIDE
004700     DISPLAY 'RUN:'  TESTS-RUN  ' OK:'  PASSES  ' KO:'  FAILURES
004800     DISPLAY L-SEP
004900
005000     GOBACK.
005100
005200 APPELS.
005300     CALL 'DATEFMT' USING BY CONTENT INPUT-DATE
005400                              BY REFERENCE RESULT-DATE
005500
005600     DISPLAY '******** ' LIB '*********'
005700     DISPLAY 'INPUT  : [' INPUT-DATE ']'
005800     DISPLAY 'OUTPUT : [' RESULT-DATE ']'
005900     CALL 'ASSEQDT' USING BY REFERENCE TEST-CONTEXT
006000                           BY CONTENT LIB
006100                           BY CONTENT EXPECTED-RESULT
006200                           BY CONTENT RESULT-DATE.
006300
006400 DATE-OCTOBER-TEST.
006500     MOVE SPACES TO RESULT-DATE
006600     MOVE '20241032' TO INPUT-DATE
006700     MOVE 'ERREUR DATE AU DELA DU 31' TO EXPECTED-RESULT
006800     MOVE 'DATE-OCTOBER-TEST' TO LIB
006900     PERFORM APPELS.


007100 JOUR-DE-L-AN-TEST.
007200     MOVE SPACES TO RESULT-DATE
007300     MOVE '20250101' TO INPUT-DATE
007400     MOVE 'WEDNESDAY, JANUARY   01, 2025' TO EXPECTED-RESULT
007500     MOVE 'JOUR-DE-L-AN-TEST' TO LIB
007600     PERFORM APPELS.
007000
007100 FEVRIER-BISSEX-TEST.
007200     MOVE SPACES TO RESULT-DATE
007300     MOVE '20240229' TO INPUT-DATE
007400     MOVE 'THURSDAY , FEBRUARY  29, 2024' TO EXPECTED-RESULT
007500     MOVE 'FEVRIER-BISSEX-TEST' TO LIB
007600     PERFORM APPELS.

007700

008400
008500 FEVR-NON-BISSEX-TEST.
008600     MOVE SPACES TO RESULT-DATE
008700     MOVE '19890229' TO INPUT-DATE
008800     MOVE 'N EXISTE PAS' TO EXPECTED-RESULT
008900     MOVE 'FEVR-NON-BISSEX-TEST' TO LIB
009000     PERFORM APPELS.

007800 FEVR-1900-TEST.
007900     MOVE SPACES TO RESULT-DATE
008000     MOVE '19000229' TO INPUT-DATE
008100     MOVE 'N EXISTE PAS' TO EXPECTED-RESULT
008200     MOVE 'FEVR-1900-TEST' TO LIB
008300     PERFORM APPELS.

007800 DIMANCHE-CHG-HEURE-TEST.
007900     MOVE SPACES TO RESULT-DATE
008000     MOVE '20250330' TO INPUT-DATE
008100     MOVE 'SUNDAY   , MARCH     30, 2025' TO EXPECTED-RESULT
008200     MOVE 'DIMANCHE-CHG-HEURE-TEST' TO LIB
008300     PERFORM APPELS.
009100

007600 TEST-DATE-VIDE.
007700     MOVE SPACES TO RESULT-DATE
007800     MOVE SPACES TO INPUT-DATE
007900* DATE COURANTE ATTENDUE - A ADAPTER SELON L'EXECUTION
008000     MOVE 'TEST-DATE-VIDE (DATE COURANTE)' TO LIB
008100     CALL 'DATEFMT' USING BY REFERENCE INPUT-DATE
008200                          BY REFERENCE RESULT-DATE
008300     DISPLAY '******** ' LIB ' *********'
008400     DISPLAY 'DATE FORMATEE : [' RESULT-DATE ']'
008500     ADD 1 TO TESTS-RUN
008600     ADD 1 TO PASSES.
008700

